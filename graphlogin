import requests

# === Azure AD Application Credentials ===
tenant_id = "YOUR_TENANT_ID"
client_id = "YOUR_CLIENT_ID"
client_secret = "YOUR_CLIENT_SECRET"

# === Step 1: Authenticate with Microsoft Graph and get access token ===
token_url = f"https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token"
token_data = {
    'grant_type': 'client_credentials',
    'client_id': client_id,
    'client_secret': client_secret,
    'scope': 'https://graph.microsoft.com/.default'
}

print("Authenticating with Microsoft Graph...")
token_response = requests.post(token_url, data=token_data)
token_response.raise_for_status()
access_token = token_response.json()["access_token"]
print("Access token retrieved successfully.\n")

# === Step 2: Get SharePoint site info via Graph API ===
site_path = "/sites/1100-1084"  # This is your QA site relative path
site_host = "wellsfargoqa.sharepoint.com"
site_url = f"https://graph.microsoft.com/v1.0/sites/{site_host}:{site_path}"

headers = {
    "Authorization": f"Bearer {access_token}"
}

print(f"Connecting to SharePoint site at {site_url}...")
site_response = requests.get(site_url, headers=headers)
site_response.raise_for_status()
site_info = site_response.json()

# === Step 3: Print site title ===
print("âœ… Connected to SharePoint Site")
print("Site Title:", site_info.get("displayName"))
print("Site Web URL:", site_info.get("webUrl"))
print("Site ID:", site_info.get("id"))
