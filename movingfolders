# Define parameters
$SourceDir = "Y:\EDM-DMS\BC0b0a58e8aadC48d_0C0a58e85ec32fa_1\CR COE Quality Control\DAQC Reviews\17694820"
$DestinationDir = "C:\Users\u419556\Downloads\DMSExtract"

# Function to log messages
function Write-Log {
    param ([string]$message)
    $logFile = "C:\path\to\logfile.log"  # Update with the path to your log file
    Add-Content -Path $logFile -Value "$((Get-Date).ToString('yyyy-MM-dd HH:mm:ss')) - $message"
}

# Ensure the destination directory exists
if (-not (Test-Path -Path $DestinationDir)) {
    try {
        New-Item -ItemType Directory -Path $DestinationDir -Force | Out-Null
        Write-Log "Created destination directory: $DestinationDir"
    } catch {
        Write-Log "Error creating destination directory: $_"
        throw
    }
}

# Move entire folder to DMS
try {
    Write-Log "Moving files from $SourceDir to $DestinationDir"
    Move-Item -Path $SourceDir -Destination $DestinationDir -Recurse -Force
    Write-Log "Moved files from $SourceDir to $DestinationDir successfully"
} catch {
    Write-Log "Error moving files from $SourceDir to $DestinationDir: $_"
}
