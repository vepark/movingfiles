import PyPDF2
import difflib

# Function to extract text from a specific page of a PDF file
def extract_text_from_pdf(file_path):
    with open(file_path, "rb") as file:
        reader = PyPDF2.PdfReader(file)
        text_by_page = []
        for page_num, page in enumerate(reader.pages):
            text = page.extract_text()
            text_by_page.append((page_num + 1, text))  # Store page number with text
        return text_by_page

# Paths to the PDF files
file_a_path = "file1.pdf"
file_b_path = "file2.pdf"

try:
    # Extract text by page from both PDFs
    pdf_a_pages = extract_text_from_pdf(file_a_path)
    pdf_b_pages = extract_text_from_pdf(file_b_path)

    # Compare each page and show differences
    print("\nDifferences between PDFs (by page):")
    print("-" * 50)
    for (page_a_num, text_a), (page_b_num, text_b) in zip(pdf_a_pages, pdf_b_pages):
        # Use difflib to compare text on this page
        diff = list(difflib.unified_diff(
            text_a.splitlines(),
            text_b.splitlines(),
            lineterm=""
        ))

        # If there are differences, display the page number and differences
        if diff:
            print(f"\nPage {page_a_num}:\n")
            for line in diff:
                if line.startswith("-"):
                    print(f"Removed: {line[1:]}")
                elif line.startswith("+"):
                    print(f"Added: {line[1:]}")
    print("-" * 50)

except FileNotFoundError as e:
    print(f"Error: {e}")
except Exception as e:
    print(f"An unexpected error occurred: {e}")
